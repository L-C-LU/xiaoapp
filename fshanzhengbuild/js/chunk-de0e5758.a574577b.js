(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-de0e5758"],{"3f0e":function(t,a,e){},9601:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"i-layout-page-header"},[e("PageHeader",{attrs:{title:"用户详情",content:"","hidden-breadcrumb":"",back:""},on:{"on-back":function(a){return t.$router.back()}}})],1),e("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[e("ButtonGroup",[e("Button",{on:{click:t.handleShowStatus}},[t._v("状态变更")]),e("Button",{on:{click:t.handleShowPassword}},[t._v("密码重置")]),e("Button",{on:{click:t.handleShowUpdate}},[t._v("联系方式编辑")]),e("Button",{on:{click:t.handleShowRelation}},[t._v("角色变更")]),e("Button",{on:{click:t.handleShowDelete}},[t._v("用户删除")])],1),e("br"),e("br"),e("div",{staticClass:"data-detail"},[e("Row",{staticClass:"detail-title"},[e("Col",{attrs:{span:"2"}},[e("span",{staticClass:"title"},[t._v("基本详情")])]),e("Col",{staticClass:"ivu-text-right",staticStyle:{},attrs:{span:"22"}})],1),e("Row",{staticClass:"detail-content",attrs:{type:"flex",align:"middle"}},[e("Col",{staticClass:"label",attrs:{span:"3"}},[e("span",[t._v("微信")])]),e("Col",{staticClass:"content",attrs:{span:"5"}},[e("div",{staticStyle:{"padding-top":"5px","font-weight":"bold"}},[""!=t.detail.avatar?e("img",{staticClass:"avatar",attrs:{src:t.detail.avatar}}):t._e(),e("div",{staticClass:"nick-name"},[t._v(t._s(t.detail.nick_name||"--"))])])]),e("Col",{staticClass:"label",attrs:{span:"3"}},[e("span",[t._v("电话")])]),e("Col",{staticClass:"content",staticStyle:{"font-weight":"bold"},attrs:{span:"5"}},[e("span",[e("span",{domProps:{textContent:t._s(t.detail.mobile||"--")}})])]),e("Col",{staticClass:"label",attrs:{span:"3"}},[e("span",[t._v("姓名")])]),e("Col",{staticClass:"content bold",attrs:{span:"5"}},[e("span",{domProps:{textContent:t._s(t.detail.name||"--")}})]),e("Col",{staticClass:"label",attrs:{span:"3"}},[e("span",[t._v("邮箱")])]),e("Col",{staticClass:"content",attrs:{span:"5"}},[e("span",{domProps:{textContent:t._s(t.detail.email||"--")}})]),e("Col",{staticClass:"label",attrs:{span:"3"}},[e("span",[t._v("状态")])]),e("Col",{staticClass:"content",attrs:{span:"5"}},[0===t.detail.status?e("Badge",{attrs:{status:"error",text:"禁用"}}):t._e(),1===t.detail.status?e("Badge",{attrs:{status:"success",text:"启用"}}):t._e()],1),e("Col",{staticClass:"label",attrs:{span:"3"}},[e("span",[t._v("添加时间")])]),e("Col",{staticClass:"content",attrs:{span:"5"}},[e("span",{domProps:{textContent:t._s(t.$helper.getTimeStr(t.detail.create_time)||"--")}})]),e("Col",{staticClass:"label",attrs:{span:"3"}},[e("span",[t._v("登录次数")])]),e("Col",{staticClass:"content",attrs:{span:"5"}},[e("span",{domProps:{textContent:t._s(t.detail.login_times)}})]),e("Col",{staticClass:"label",attrs:{span:"3"}},[e("span",[t._v("最后登录时间")])]),e("Col",{staticClass:"content",attrs:{span:"5"}},[e("span",{domProps:{textContent:t._s(t.$helper.getTimeStr(t.detail.last_login_time)||"--")}})]),e("Col",{staticClass:"label",attrs:{span:"3"}},[e("span",[t._v("最后登录Ip地址")])]),e("Col",{staticClass:"content",attrs:{span:"5"}},[e("span",{domProps:{textContent:t._s(t.detail.last_login_ip||"--")}})])],1)],1),e("div",{staticClass:"i-table-no-border"}),e("Modal",{attrs:{title:"状态变更",loading:t.status.loading},on:{"on-ok":t.handleStatus},model:{value:t.status.show,callback:function(a){t.$set(t.status,"show",a)},expression:"status.show"}},[e("Form",{ref:"status",attrs:{model:t.status.data,rules:t.status.rules,"label-width":80}},[e("FormItem",{attrs:{label:"描述：",prop:"status"}},[e("RadioGroup",{model:{value:t.status.data.status,callback:function(a){t.$set(t.status.data,"status",a)},expression:"status.data.status"}},[e("Radio",{attrs:{label:0}},[t._v("禁用")]),e("Radio",{attrs:{label:1}},[t._v("启用")])],1)],1)],1)],1),e("Modal",{attrs:{title:"密码重置",loading:t.password.loading},on:{"on-ok":t.handlePassword},model:{value:t.password.show,callback:function(a){t.$set(t.password,"show",a)},expression:"password.show"}},[e("Form",{ref:"password",attrs:{model:t.password.data,rules:t.password.rules,"label-width":120}},[e("FormItem",{attrs:{label:"新密码：",prop:"password"}},[e("Input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入新的登录密码",maxlength:16,type:"password"},model:{value:t.password.data.password,callback:function(a){t.$set(t.password.data,"password","string"===typeof a?a.trim():a)},expression:"password.data.password"}})],1),e("FormItem",{attrs:{label:"确认密码：",prop:"confirm_password"}},[e("Input",{staticStyle:{width:"80%"},attrs:{placeholder:"请再次输入新的登录密码",maxlength:16,type:"password"},model:{value:t.password.data.confirm_password,callback:function(a){t.$set(t.password.data,"confirm_password","string"===typeof a?a.trim():a)},expression:"password.data.confirm_password"}})],1)],1)],1),e("Modal",{attrs:{title:"角色变更",loading:t.role.loading,width:600},on:{"on-ok":t.handleUpdateRole},model:{value:t.role.show,callback:function(a){t.$set(t.role,"show",a)},expression:"role.show"}},[e("Form",{ref:"role",attrs:{model:t.role.data,rules:t.role.rules,"label-width":120}},[e("FormItem",{attrs:{label:"用户角色：",prop:"user_type"}},[e("Select",{staticStyle:{width:"90%"},attrs:{placeholder:"请选择用户角色",clearable:""},model:{value:t.role.data.role_id,callback:function(a){t.$set(t.role.data,"role_id","string"===typeof a?a.trim():a)},expression:"role.data.role_id"}},t._l(t.dict.role,function(a,s){return e("Option",{key:s,attrs:{value:s}},[t._v(t._s(a))])}),1)],1)],1)],1),e("Modal",{attrs:{title:"用户编辑",loading:t.update.loading},on:{"on-ok":t.handleUpdate},model:{value:t.update.show,callback:function(a){t.$set(t.update,"show",a)},expression:"update.show"}},[e("Form",{ref:"update",attrs:{model:t.update.data,rules:t.update.rules,"label-width":100}},[e("FormItem",{attrs:{label:"姓名：",prop:"name"}},[e("Input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入姓名",maxlength:32},model:{value:t.update.data.name,callback:function(a){t.$set(t.update.data,"name","string"===typeof a?a.trim():a)},expression:"update.data.name"}})],1),e("FormItem",{attrs:{label:"微信昵称：",prop:"nick_name"}},[e("Input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入微信昵称",maxlength:32},model:{value:t.update.data.nick_name,callback:function(a){t.$set(t.update.data,"nick_name","string"===typeof a?a.trim():a)},expression:"update.data.nick_name"}})],1),e("FormItem",{attrs:{label:"手机号码：",prop:"mobile"}},[e("InputNumber",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入手机号码",max:9999999999999},model:{value:t.update.data.mobile,callback:function(a){t.$set(t.update.data,"mobile",t._n(a))},expression:"update.data.mobile"}})],1),e("FormItem",{attrs:{label:"电子邮箱：",prop:"email"}},[e("Input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入电子邮箱",maxlength:32},model:{value:t.update.data.email,callback:function(a){t.$set(t.update.data,"email","string"===typeof a?a.trim():a)},expression:"update.data.email"}})],1),e("FormItem",{attrs:{label:"微信：",prop:"wechat"}},[e("Input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入微信号码",maxlength:32},model:{value:t.update.data.wechat,callback:function(a){t.$set(t.update.data,"wechat","string"===typeof a?a.trim():a)},expression:"update.data.wechat"}})],1),e("FormItem",{attrs:{label:"微信昵称：",prop:"nick_name"}},[e("Input",{staticStyle:{width:"90%"},attrs:{placeholder:"请输入微信昵称",maxlength:32},model:{value:t.update.data.nick_name,callback:function(a){t.$set(t.update.data,"nick_name","string"===typeof a?a.trim():a)},expression:"update.data.nick_name"}})],1)],1)],1)],1)],1)},n=[],i=e("a34a"),r=e.n(i);function o(t,a,e,s,n,i,r){try{var o=t[i](r),l=o.value}catch(d){return void e(d)}o.done?a(l):Promise.resolve(l).then(s,n)}function l(t){return function(){var a=this,e=arguments;return new Promise(function(s,n){var i=t.apply(a,e);function r(t){o(i,s,n,r,l,"next",t)}function l(t){o(i,s,n,r,l,"throw",t)}r(void 0)})}}var d={name:"user-user-detail",data:function(){var t=this,a=function(t,a,e){""===a&&e(new Error("请输入新的登录密码,6-16位")),a.length<6?e(new Error("登录密码至少为6位")):e()},e=function(a,e,s){""===e&&s(new Error("请再次输入新的登录密码,6-16位")),e!==t.password.data.password?s(new Error("两次输入密码不一致")):s()},s=function(t,a,e){""===a&&e(new Error("请输入用户姓名"));var s=/^[\u0391-\uFFE5]{1,8}$/;s.test(a)?e():e(new Error("用户姓名格式不正确，1-8位中文"))},n=function(t,a,e){if(""===a)e();else{var s=/^[a-zA-Z0-9_-]{5,20}$/;s.test(a)?e():e(new Error("微信号码格式不正确"))}};return{timer:0,loading_user:!1,userList:[],columns:[{title:"序号",minWidth:65,render:function(a,e){return a("div",e.index+1+parseInt(t.data.pageSize)*(parseInt(t.data.page)-1))}},{title:"用户帐号",key:"username",minWidth:100},{title:"用户角色",key:"role_text",minWidth:100},{title:"联系方式",slot:"contact",minWidth:140},{title:"添加时间",key:"create_time",slot:"create_time",minWidth:120,sortable:"custom"},{title:"最后登录",key:"last_login_time",slot:"last_login_time",minWidth:140,sortable:"custom"},{title:"状态",slot:"status",minWidth:100},{title:"操作",slot:"action",align:"center",minWidth:140}],id:0,imageDomain:"",loading:!1,dict:{},detail:{},status:{show:!1,loading:!0,data:{status:0},rules:{}},level:{show:!1,loading:!0,data:{level:0},rules:{}},role:{show:!1,loading:!0,loading1:!1,data:{role_id:0},rules:{}},password:{show:!1,loading:!0,data:{password:""},rules:{password:[{required:!0,validator:a,trigger:"blur"}],confirm_password:[{required:!0,validator:e,trigger:"blur"}]}},delete:{show:!1,loading:!0},update:{loading:!0,show:!1,data:{name:"",nick_name:"",mobile:"",email:"",wechat:""},rules:{name:[{required:!0,validator:s,trigger:"blur"}],nick_name:[{required:!0,message:"请输入微信昵称",trigger:"blur"}],mobile:[{required:!1,message:"请输入正确的手机号码,11位数字",min:1e10,max:99999999999,trigger:"blur",type:"number"}],email:[{required:!1,message:"请输入正确的电子邮箱",trigger:"blur",type:"email"}],wechat:[{required:!1,validator:n,trigger:"blur"}]}}}},computed:{},methods:{getDetail:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!0;var e={user_id:this.userId};e.dict=a?"role":"",this.$http.query("/Manage/User/get",e).then(function(){var e=l(r.a.mark(function e(s){return r.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a&&(t.dict=s.dict),t.detail=s.detail,t.loading=!1;case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(t){console.log(t)})},handleShowStatus:function(){this.status.data.status=this.detail.status,this.status.show=!0},handleShowLevel:function(){this.level.data.level=this.detail.phone_level.toString(),this.level.show=!0},changeSelect:function(){this.$refs.user.query=""},queryUserList:function(t){var a=this;clearTimeout(this.timer),this.timer=setTimeout(function(){var e={keyword:t};a.loading_user=!0,a.userList=[],a.$http.query("/Manage/User/userSelect",e).then(function(){var t=l(r.a.mark(function t(e){var s;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:for(s=0;s<e.list.length;s++)a.userList.push(e.list[s]);a.loading_user=!1;case 2:case"end":return t.stop()}},t)}));return function(a){return t.apply(this,arguments)}}()).catch(function(t){console.log(t)})},500)},handleStatus:function(){var t=this,a={user_id:this.userId,status:this.status.data.status};this.$http.query("/Manage/User/setStatus",a).then(function(){var a=l(r.a.mark(function a(e){return r.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t.$Message.success("操作成功"),t.status.show=!1,t.getDetail();case 3:case"end":return a.stop()}},a)}));return function(t){return a.apply(this,arguments)}}()).catch(function(t){console.log(t)}),this.status.loading=!1,this.$nextTick(function(){t.status.loading=!0})},handleLevel:function(){var t=this,a={user_id:this.userId,level:this.level.data.level};this.$http.query("/Manage/User/setLevel",a).then(function(){var a=l(r.a.mark(function a(e){return r.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t.$Message.success("操作成功"),t.level.show=!1,t.getDetail();case 3:case"end":return a.stop()}},a)}));return function(t){return a.apply(this,arguments)}}()).catch(function(t){console.log(t)}),this.level.loading=!1,this.$nextTick(function(){t.level.loading=!0})},handleUpdateValue:function(t,a){var e=this,s={user_id:this.userId,column_name:t,value:a?0:1};this.$http.query("/Manage/User/setColumnValue",s).then(function(){var t=l(r.a.mark(function t(a){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.$Message.success("操作成功"),e.getDetail();case 2:case"end":return t.stop()}},t)}));return function(a){return t.apply(this,arguments)}}()).catch(function(t){console.log(t)})},handleShowPassword:function(){this.password.show=!0},handleShowRelation:function(){this.role.show=!0,this.role.data.role_id=this.detail.role_id.toString(),this.role.data.user_id=this.detail.father.user_id},handlePassword:function(){var t=this;this.$refs.password.validate(function(a){if(a){var e=t.password.data;e.user_id=t.userId,t.$http.query("/Manage/User/setPassword",e).then(function(){var a=l(r.a.mark(function a(e){return r.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t.$Message.success("操作成功"),t.password.show=!1,t.password.loading=!1,t.$nextTick(function(){t.password.loading=!0});case 4:case"end":return a.stop()}},a)}));return function(t){return a.apply(this,arguments)}}()).catch(function(t){console.log(t)}),t.password.loading=!1,t.$nextTick(function(){t.password.loading=!0})}t.password.loading=!1,t.$nextTick(function(){t.password.loading=!0})})},handleUpdateRole:function(){var t=this;this.$refs.role.validate(function(a){if(a){var e=t.role.data;e.user_id=t.userId,t.$http.query("/Manage/User/setRole",e).then(function(){var a=l(r.a.mark(function a(e){return r.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t.$Message.success("操作成功"),t.role.show=!1,t.role.loading=!1,t.$nextTick(function(){t.role.loading=!0});case 4:case"end":return a.stop()}},a)}));return function(t){return a.apply(this,arguments)}}()).catch(function(t){console.log(t)}),t.role.loading=!1,t.$nextTick(function(){t.role.loading=!0})}t.role.loading=!1,t.$nextTick(function(){t.role.loading=!0})})},handleShowUpdate:function(){this.update.data.name=this.detail.name,this.update.data.contact_name=this.detail.contact_name,this.update.data.mobile=parseInt(this.detail.mobile),this.update.data.wechat=this.detail.wechat,this.update.data.nick_name=this.detail.nick_name,this.update.data.email=this.detail.email,this.update.data.user_id=this.userId,this.update.show=!0},handleUpdate:function(){var t=this;this.$refs.update.validate(function(a){if(a){var e=t.update.data;t.$http.query("/Manage/User/update",e).then(function(){var a=l(r.a.mark(function a(e){return r.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t.$Message.success("操作成功"),t.update.show=!1,t.update.loading=!1,t.getDetail(),t.$nextTick(function(){t.update.loading=!0});case 5:case"end":return a.stop()}},a)}));return function(t){return a.apply(this,arguments)}}()).catch(function(t){console.log(t)}),t.update.loading=!1,t.$nextTick(function(){t.update.loading=!0})}t.update.loading=!1,t.$nextTick(function(){t.update.loading=!0})})},handleShowDelete:function(){var t=this;this.$Modal.confirm({title:"删除用户",content:"确定删除该用户吗？",onOk:function(){var a={user_id:t.userId};t.$http.query("/Manage/User/delete",a).then(function(){var a=l(r.a.mark(function a(e){return r.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t.$Message.success("用户删除成功"),t.getList();case 2:case"end":return a.stop()}},a)}));return function(t){return a.apply(this,arguments)}}())}})}},mounted:function(){var t=this.$route.params.user_id;this.userId=t,this.getDetail(!0)}},u=d,c=(e("d10b"),e("2877")),p=Object(c["a"])(u,s,n,!1,null,"85d24d16",null);a["default"]=p.exports},d10b:function(t,a,e){"use strict";var s=e("3f0e"),n=e.n(s);n.a}}]);
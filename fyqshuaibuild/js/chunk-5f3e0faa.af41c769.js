(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f3e0faa"],{2120:function(t,e,a){},b2b6:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"i-layout-page-header"},[a("PageHeader",{attrs:{title:"订单列表",content:"","hidden-breadcrumb":""}})],1),a("Card",{staticClass:"ivu-mt",attrs:{bordered:!1,"dis-hover":""}},[a("div",[a("Form",{ref:"form",attrs:{model:t.formData,rules:t.rules,"label-width":t.labelWidth,"label-position":t.labelPosition}},[a("Row",{attrs:{gutter:24,type:"flex",justify:"end"}},[a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"关键字",prop:"keyword","label-for":"keyword"}},[a("Input",{attrs:{placeholder:"用户或商家姓名/手机号/地址",clearable:"","element-id":"keyword"},model:{value:t.formData.keyword,callback:function(e){t.$set(t.formData,"keyword",e)},expression:"formData.keyword"}})],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"店铺",prop:"shop_id"}},[a("Select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择店铺",filterable:"",clearable:""},model:{value:t.formData.shop_id,callback:function(e){t.$set(t.formData,"shop_id",e)},expression:"formData.shop_id"}},t._l(t.dict.shop,function(e,r){return a("Option",{key:r,attrs:{value:r}},[t._v(t._s(e))])}),1)],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"支付状态",prop:"pay_status"}},[a("Select",{attrs:{placeholder:"请选择支付状态",clearable:""},model:{value:t.formData.pay_status,callback:function(e){t.$set(t.formData,"pay_status","string"===typeof e?e.trim():e)},expression:"formData.pay_status"}},[a("Option",{attrs:{value:"0"}},[t._v("未付款")]),a("Option",{attrs:{value:"1"}},[t._v("已付款")])],1)],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"订单状态",prop:"delivery_type"}},[a("Select",{attrs:{placeholder:"请选择订单状态",clearable:""},model:{value:t.formData.delivery_type,callback:function(e){t.$set(t.formData,"delivery_type","string"===typeof e?e.trim():e)},expression:"formData.delivery_type"}},[a("Option",{attrs:{value:"3"}},[t._v("待接单")]),a("Option",{attrs:{value:"2"}},[t._v("待送达")]),a("Option",{attrs:{value:"1"}},[t._v("已送达")])],1)],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"下单时间",prop:"create_time"}},[a("Row",t._b({},"Row",t.grid,!1),[a("Col",{attrs:{span:"12"}},[a("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date","show-week-numbers":"",placeholder:"起始时间"},model:{value:t.formData.create_time_begin,callback:function(e){t.$set(t.formData,"create_time_begin",e)},expression:"formData.create_time_begin"}})],1),a("Col",{attrs:{span:"12"}},[a("DatePicker",{staticStyle:{width:"99%","margin-left":"1%"},attrs:{type:"date","show-week-numbers":"",placeholder:"终止时间"},model:{value:t.formData.create_time_end,callback:function(e){t.$set(t.formData,"create_time_end",e)},expression:"formData.create_time_end"}})],1)],1)],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"送达时间",prop:"delivery_at_time"}},[a("TimePicker",{staticStyle:{width:"99%"},attrs:{format:"HH:mm",placeholder:"请选择送达时间"},model:{value:t.formData.delivery_at_time,callback:function(e){t.$set(t.formData,"delivery_at_time",e)},expression:"formData.delivery_at_time"}})],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"配送员Id",prop:"delivery_user_id"}},[a("Input",{attrs:{placeholder:"配送员的用户Id",clearable:""},model:{value:t.formData.delivery_user_id,callback:function(e){t.$set(t.formData,"delivery_user_id",e)},expression:"formData.delivery_user_id"}})],1)],1),a("Col",t._b({},"Col",t.grid,!1),[a("FormItem",{attrs:{label:"楼号",prop:"address"}},[a("Select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择楼号",filterable:"",clearable:""},model:{value:t.formData.address,callback:function(e){t.$set(t.formData,"address",e)},expression:"formData.address"}},t._l(t.dict.address,function(e,r){return a("Option",{key:r,attrs:{value:r}},[t._v(t._s(e))])}),1)],1)],1),a("Col",t._b({staticClass:"ivu-text-right"},"Col",t.grid,!1),[a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("查询")]),a("Button",{staticClass:"ivu-ml-8",on:{click:t.handleReset}},[t._v("重置")]),t._e()],1)],1)],1)],1),a("div",{staticClass:"i-table-no-border"},[a("Table",{ref:"table",staticClass:"ivu-mt",attrs:{columns:t.columns,data:t.data.list,loading:t.loading,border:"","show-header":""},on:{"on-sort-change":t.handleSortChange},scopedSlots:t._u([{key:"pay_status",fn:function(e){var r=e.row;return[a("div",{staticClass:"table-div"},[t._v("\n                            客户："+t._s(1==r.pay_status?"已付款":"未付款")+"\n                            "),a("br"),t._v("\n                            商家："+t._s(1==r.is_settled?"已结算":"未结算")+"\n                        ")])]}},{key:"shop",fn:function(e){var r=e.row;return[a("div",{staticStyle:{"line-height":"180%","margin-top":"5px","margin-bottom":"5px"}},[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.setShopId(r.shop_id)}}},[a("b",[a("u",[t._v(t._s(r.shop_name)+":"+t._s(r.today_no)+"号")])])]),a("br"),t._v("\n                            "+t._s(r.shop_contact_name)),a("br"),t._v("\n                            "+t._s(r.shop_contact_mobile)+"\n                        ")])]}},{key:"goods",fn:function(e){var r=e.row;return[a("div",{staticStyle:{"line-height":"180%","margin-top":"5px","margin-bottom":"5px"}},[t._l(r.goods_list,function(e,r){return a("div",{key:r,staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",[t._v("\n                                    "+t._s(e.name)+" "+t._s(e.price)+"X"+t._s(e.count)+"\n                                ")]),a("div",[t._v(t._s(e.amount))])])}),a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",[t._v("打包费")]),a("div",[t._v(t._s(r.box_price))])]),a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",[t._v("配送费")]),a("div",[t._v(t._s(r.delivery_price))])]),a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",[t._v("服务费")]),a("div",{staticStyle:{color:"green"}},[t._v("\n                                    -"+t._s(r.service_fee)+"\n                                ")])]),a("div",{staticStyle:{display:"flex","justify-content":"space-between"}},[a("div",[t._v("合计")]),a("div",{staticStyle:{color:"red"}},[a("b",[t._v(t._s(r.shop_income))])])])],2)]}},{key:"address",fn:function(e){var r=e.row;return[a("div",{staticStyle:{"line-height":"180%","margin-top":"5px","margin-bottom":"5px","font-weight":"bold",color:"#777"}},[t._v("\n                            "+t._s(r.customer_address)),a("br"),t._v("\n                            "+t._s(r.customer_name)),a("br"),t._v("\n                            "+t._s(r.customer_mobile)+"\n                        ")])]}},{key:"price",fn:function(e){var r=e.row;return[a("div",{staticStyle:{"font-weight":"bold",color:"red"}},[t._v("\n                            "+t._s(r.price)+"\n                        ")])]}},{key:"delivery_at_time_str",fn:function(e){var r=e.row;return[a("div",{staticClass:"table-div"},[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(e){return t.setDeliveryAtTime(r.delivery_at_time_str)}}},[a("b",[a("u",[t._v(t._s(r.delivery_at_time_str))])])])])]}},{key:"delivery_status",fn:function(e){var r=e.row;return[a("div",{staticClass:"table-div"},[0==r.delivery_status&&0==r.delivery_user_id?a("Badge",{attrs:{status:"default",text:"待接单"}}):0==r.delivery_status&&r.delivery_user_id>0?a("Badge",{attrs:{status:"processing",text:"待送达"}}):1==r.delivery_status?a("Badge",{attrs:{status:"success",text:"已送达"}}):t._e(),r.delivery_user_name?a("div",[t._v("\n                                配送员："),a("br"),t._v("\n                                "+t._s(r.delivery_user_name)),a("br"),t._v("\n                                "+t._s(r.delivery_user_mobile)+"\n                            ")]):t._e()],1)]}},{key:"create_time",fn:function(e){var a=e.row;return[t._v("\n                        "+t._s(t.$helper.getTimeStr(a.create_time))+"\n                    ")]}},{key:"action",fn:function(e){e.row;var r=e.index;return[a("a",{on:{click:function(e){return t.handleArrive(r)}}},[t._v("一键送达")]),a("a",{staticStyle:{"margin-left":"16px"},on:{click:function(e){return t.handlePrint(r)}}},[t._v("重新打印")])]}}])}),a("div",{staticClass:"ivu-mt ivu-text-center"},[a("div",{staticStyle:{float:"left"}},[a("Button",{staticClass:"ivu-ml-8",attrs:{type:"info"},on:{click:t.handleArriveBatch}},[t._v("一键送达")])],1),a("Page",{attrs:{total:t.data.total,current:t.data.page,"show-total":"","show-sizer":"","page-size-opts":[10,20,50,100],"show-elevator":!0},on:{"update:current":function(e){return t.$set(t.data,"page",e)},"on-change":t.handleToPage,"on-page-size-change":t.handlePageSize}})],1)],1)],1)])],1)},i=[],n=a("a34a"),s=a.n(n),o=a("2f62");function l(t,e,a,r,i,n,s){try{var o=t[n](s),l=o.value}catch(c){return void a(c)}o.done?e(l):Promise.resolve(l).then(r,i)}function c(t){return function(){var e=this,a=arguments;return new Promise(function(r,i){var n=t.apply(e,a);function s(t){l(n,r,i,s,o,"next",t)}function o(t){l(n,r,i,s,o,"throw",t)}s(void 0)})}}function d(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?d(a,!0).forEach(function(e){p(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):d(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function p(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var _={name:"order-order-list",data:function(){var t=this;return{addressList:{},formData:{keyword:"",create_time:"",device_type:"",area_id:"",pay_status:"1",delivery_at_time:"",shop_id:"",delivery_type:"3",for_here_type:0},rules:{},grid:{xl:8,lg:8,md:8,sm:24,xs:24},columns:[{type:"selection",minWidth:60,align:"center",show:!0},{title:"序号",width:65,render:function(e,a){return e("div",a.index+1+parseInt(t.data.page_size)*(parseInt(t.data.page)-1))}},{title:"订单号",key:"order_id",minWidth:120},{title:"送达时间",slot:"delivery_at_time_str",minWidth:90},{title:"商品",slot:"goods",minWidth:160},{title:"商家",slot:"shop",minWidth:100},{title:"配送地址",slot:"address",minWidth:140},{title:"订单状态",slot:"delivery_status",minWidth:90},{title:"支付状态",key:"pay_status",slot:"pay_status",minWidth:90,sortable:"custom"},{title:"下单时间",slot:"create_time",minWidth:120,sortable:"custom"},{title:"操作",slot:"action",align:"center",minWidth:120}],loading:!1,dict:{role:{}},data:{list:[],page:1,page_size:10,page_count:0,total:0},sort_column:"",sort_direction:""}},computed:u({},Object(o["e"])("admin/layout",["isMobile"]),{labelWidth:function(){return this.isMobile?void 0:100},labelPosition:function(){return this.isMobile?"top":"right"}}),methods:{setDeliveryAtTime:function(t){this.formData.delivery_at_time=t,this.data.page=1,this.getList()},setShopId:function(t){this.formData.shop_id=t.toString(),this.data.page=1,this.getList()},handleExport:function(){this.data.export=1,this.getList()},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!0;var a={page_size:this.data.page_size,page:this.data.page,sort_column:this.sort_column,sort_direction:this.sort_direction,export:this.data.export};a=Object.assign(this.formData,a),a.create_time=[this.formData.create_time_begin,this.formData.create_time_end],a.dict=e?"shop,address":"",1==this.data.export?(this.$http.download("/Manage/Order/list",a),this.loading=!1):this.$http.query("/Manage/Order/list",a).then(function(){var a=c(s.a.mark(function a(r){return s.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:console.log(r),e&&(t.dict=r.dict),t.data.list=r.list,t.data.total=r.total,t.data.page=r.page,t.data.page_size=r.page_size,t.data.page_count=r.page_count,t.loading=!1;case 8:case"end":return a.stop()}},a)}));return function(t){return a.apply(this,arguments)}}()).catch(function(t){console.log(t)})},getOrderStatus:function(t){return 1==t?"已完成":2==t?"已取消":0==t?"已提交":void 0},handleStatus:function(t,e){var a=this,r={goods_id:t,status:e?0:1};this.$http.query("/Manage/Goods/setStatus",r).then(function(){var t=c(s.a.mark(function t(e){return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:a.$Message.success("状态更改成功");case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())},handleSubmit:function(){this.data.export=0,this.getList()},handleToPage:function(t){this.data.export=0,this.data.page=t,this.getList()},handlePageSize:function(t){this.data.export=1,this.data.page_size=t,this.data.page=0,this.getList()},handleReset:function(){this.formData.create_time_begin="",this.formData.create_time_end="",this.$refs.form.resetFields()},handleToDetail:function(t){this.$router.push({path:"/order/order-detail/".concat(this.data.list[t].order_id)})},handleArriveBatch:function(){var t=this,e=this.$refs.table.getSelection(),a=[];e.forEach(function(t){a.push(t.order_id)}),a.length<=0?this.$Message.warning("请选择订单"):this.$http.query("/Manage/Order/arriveBatch",{order_ids:a}).then(function(){var e=c(s.a.mark(function e(a){return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.$Message.success("订单一键送达操作成功"),t.data.export=0,t.getList();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())},handleDelete:function(t){var e=this;this.$Modal.confirm({title:"删除订单",content:"确定删除该订单吗？",onOk:function(){var a={order_id:e.data.list[t].order_id};e.$http.query("/Manage/Order/delete",a).then(function(){var t=c(s.a.mark(function t(a){return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.$Message.success("订单删除成功"),e.data.export=0,e.getList();case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}})},handleArrive:function(t){var e=this;this.$Modal.confirm({title:"确认送达",content:"确定该订单已送达吗？",onOk:function(){var a={order_id:e.data.list[t].order_id};e.$http.query("/Manage/Order/arrive",a).then(function(){var t=c(s.a.mark(function t(a){return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.$Message.success("订单送达操作成功"),e.data.export=0,e.getList();case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}})},handlePrint:function(t){var e=this;this.$Modal.confirm({title:"重新打印",content:"确定重新打印该订单吗？",onOk:function(){var a={order_id:e.data.list[t].order_id};e.$http.query("/Manage/Order/print",a).then(function(){var t=c(s.a.mark(function t(a){return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.$Message.success("订单送达操作成功"),e.data.export=0;case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())}})},handleSortChange:function(t){var e=t.key,a=t.order;this.sort_column=e,this.sort_direction=a,this.data.page=1,this.data.export=0,this.getList()}},mounted:function(){this.data.export=0,this.getList(!0)}},h=_,f=(a("b439"),a("2877")),v=Object(f["a"])(h,r,i,!1,null,null,null);e["default"]=v.exports},b439:function(t,e,a){"use strict";var r=a("2120"),i=a.n(r);i.a}}]);